<!DOCTYPE html>
<html>
Â <head>
Â Â Â <base target="_top">
Â Â Â <meta charset="utf-8">
Â Â Â <title>ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚²ãƒ¼ãƒ </title>
Â Â Â <style>
Â Â Â Â Â html, body {
Â Â Â Â Â Â Â margin: 0;
Â Â Â Â Â Â Â padding: 0;
Â Â Â Â Â Â Â background: black;
Â Â Â Â Â Â Â height: 100%;
Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â justify-content: center;
Â Â Â Â Â Â Â align-items: center;
Â Â Â Â Â Â Â color: white;
Â Â Â Â Â Â Â font-family: sans-serif;
Â Â Â Â Â }

Â Â Â Â Â #gameContainer {
Â Â Â Â Â Â Â position: relative;
Â Â Â Â Â Â Â display: flex;
Â Â Â Â Â Â Â width: 90%;
Â Â Â Â Â Â Â height: 100%;
Â Â Â Â Â Â Â max-width: 1000px;
Â Â Â Â Â Â Â margin: 0 auto;
Â Â Â Â Â Â Â margin-left:50px;
Â Â Â Â Â }

Â Â Â Â Â canvas {
Â Â Â Â Â Â Â display: block;
Â Â Â Â Â Â Â background: black;
Â Â Â Â Â Â Â border-left: 4px solid white;Â  /* ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ã®å·¦å¢ƒç•Œç·š */
Â Â Â Â Â Â Â border-right: 4px solid white;
Â Â Â Â Â Â Â border-top: 4px solid white; Â  /* ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ã®ä¸Šå¢ƒç•Œç·š */
Â Â Â Â Â Â Â border-bottom: 2px solid white; /* ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ã®ä¸‹å¢ƒç•Œç·š */
Â Â Â Â Â }

Â Â Â Â Â #score, #gameOver, #retryButton {
Â Â Â Â Â Â Â position: absolute;
Â Â Â Â Â Â Â z-index: 10;
Â Â Â Â Â Â Â font-family: sans-serif;
Â Â Â Â Â }

#score {
Â position: absolute;
Â bottom: 10px; /* ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚³ãƒ³ãƒ†ãƒŠã®ä¸‹ã‹ã‚‰10px */
Â left: 950px; Â  /* å·¦ã‹ã‚‰10px */
Â color: green;
Â font-size: 50px;
}



Â Â Â Â Â #gameOver {
Â Â Â Â Â Â Â top: 40%;
Â Â Â Â Â Â Â width: 100%;
Â Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â Â font-size: 40px;
Â Â Â Â Â Â Â color: red;
Â Â Â Â Â Â Â display: none;
Â Â Â Â Â }

Â Â Â Â Â #retryButton {
Â Â Â Â Â Â Â top: 50%;
Â Â Â Â Â Â Â left: 50%;
Â Â Â Â Â Â Â transform: translate(-50%, -50%);
Â Â Â Â Â Â Â font-size: 24px;
Â Â Â Â Â Â Â padding: 10px 20px;
Â Â Â Â Â Â Â background-color: #4CAF50;
Â Â Â Â Â Â Â color: white;
Â Â Â Â Â Â Â border: none;
Â Â Â Â Â Â Â cursor: pointer;
Â Â Â Â Â Â Â display: none;
Â Â Â Â Â }

Â Â Â Â Â #rankingContainer {
Â Â Â Â Â Â Â width: 500px;
Â Â Â Â Â Â Â padding: 0px;
Â Â Â Â Â Â Â border-left: 2px solid white;
Â Â Â Â Â Â Â border-right:1px;
Â Â Â Â Â Â Â height: 100%;
Â Â Â Â Â Â Â overflow-y: auto;
Â Â Â Â Â Â Â background-color: rgba(0, 0, 0, 0.7);
Â Â Â Â Â Â Â text-align: center;
Â Â Â Â Â Â Â font-size: 16px;
Â Â Â Â Â Â Â color: white;
Â Â Â Â Â Â Â box-sizing: border-box;
Â Â Â Â Â }

Â Â Â Â Â #ranking ol {
Â Â Â Â Â Â Â padding-left: 30px;
Â Â Â Â Â Â Â margin-top: 5px;

Â Â Â Â Â }

Â Â Â Â Â .loader {
Â Â Â Â Â Â Â border: 6px solid #f3f3f3;
Â Â Â Â Â Â Â border-top: 6px solid #00ff00;
Â Â Â Â Â Â Â border-radius: 50%;
Â Â Â Â Â Â Â width: 30px;
Â Â Â Â Â Â Â height: 30px;
Â Â Â Â Â Â Â animation: spin 1s linear infinite;
Â Â Â Â Â Â Â margin: 10px auto;
Â Â Â Â Â }

Â Â Â Â Â @keyframes spin {
Â Â Â Â Â Â Â 0% { transform: rotate(0deg); }
Â Â Â Â Â Â Â 100% { transform: rotate(360deg); }
Â Â Â Â Â }
Â Â Â </style>
Â </head>
Â <body>
Â Â Â <div id="gameContainer">
Â Â Â Â Â <canvas id="gameCanvas" width="800" height="600"></canvas>
Â Â Â Â Â <div id="rankingContainer">
Â Â Â Â Â Â Â <div id="spinner" class="loader" style="display: none;"></div>
Â Â Â Â Â Â Â <div id="ranking">èª­ã¿è¾¼ã¿ä¸­...</div>
Â Â Â Â Â </div>
Â Â Â </div>

Â Â Â <div id="score">Score: 0</div>
Â Â Â <div id="gameOver">GAME OVER</div>
Â Â Â <button id="retryButton">Retry</button>

Â Â Â <script>
Â Â Â Â Â const canvas = document.getElementById("gameCanvas");
Â Â Â Â Â const ctx = canvas.getContext("2d");

Â Â Â Â Â const scoreDisplay = document.getElementById("score");
Â Â Â Â Â const gameOverDisplay = document.getElementById("gameOver");
Â Â Â Â Â const retryButton = document.getElementById("retryButton");
Â Â Â Â Â const rankingDisplay = document.getElementById("ranking");
Â Â Â Â Â const spinner = document.getElementById("spinner");

Â Â Â Â Â let player, bullets, enemies, score, gameOver, enemyInterval;
Â Â Â Â Â let lastShot = 0;

Â Â Â Â Â const GAME_WIDTH = canvas.width;
Â Â Â Â Â const GAME_HEIGHT = canvas.height;

Â Â Â Â Â function resetGame() {
Â Â Â Â Â Â Â const pw = 60;
Â Â Â Â Â Â Â const ph = 15;
Â Â Â Â Â Â Â player = { x: GAME_WIDTH / 2 - pw / 2, y: GAME_HEIGHT - 60, w: pw, h: ph };
Â Â Â Â Â Â Â bullets = [];
Â Â Â Â Â Â Â enemies = [];
Â Â Â Â Â Â Â score = 0;
Â Â Â Â Â Â Â gameOver = false;
Â Â Â Â Â Â Â scoreDisplay.textContent = "Score: " + score;
Â Â Â Â Â Â Â gameOverDisplay.style.display = "none";
Â Â Â Â Â Â Â retryButton.style.display = "none";

Â Â Â Â Â Â Â fetchRanking();

Â Â Â Â Â Â Â enemyInterval = setInterval(() => {
Â Â Â Â Â Â Â Â Â if (gameOver) return;
Â Â Â Â Â Â Â Â Â for (let i = 0; i < 2; i++) {
Â Â Â Â Â Â Â Â Â Â Â const x = Math.random() * (GAME_WIDTH - 30);
Â Â Â Â Â Â Â Â Â Â Â enemies.push({ x: x, y: 0, w: 30, h: 30, speed: 1 });
Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â }, 1000);

Â Â Â Â Â Â Â update();
Â Â Â Â Â }

Â Â Â Â Â function handleInput(x) {
Â Â Â Â Â Â Â if (gameOver) return;
Â Â Â Â Â Â Â const now = Date.now();
Â Â Â Â Â Â Â if (now - lastShot < 200) return;
Â Â Â Â Â Â Â lastShot = now;
Â Â Â Â Â Â Â const rect = canvas.getBoundingClientRect();
Â Â Â Â Â Â Â const canvasX = x - rect.left;
Â Â Â Â Â Â Â player.x = Math.max(0, Math.min(GAME_WIDTH - player.w, canvasX - player.w / 2));

Â Â Â Â Â Â Â // å¼¾ã‚’ç™ºå°„ã™ã‚‹
Â Â Â Â Â Â Â bullets.push({ x: player.x + player.w / 2 - 2, y: player.y, w: 4, h: 10 });
Â Â Â Â Â }

Â Â Â Â Â canvas.addEventListener("touchstart", e => {
Â Â Â Â Â Â Â e.preventDefault();
Â Â Â Â Â Â Â const touch = e.touches[0];
Â Â Â Â Â Â Â handleInput(touch.clientX);
Â Â Â Â Â });

Â Â Â Â Â canvas.addEventListener("mousedown", e => {
Â Â Â Â Â Â Â handleInput(e.clientX);
Â Â Â Â Â });

Â Â Â Â Â retryButton.addEventListener("click", () => {
Â Â Â Â Â Â Â clearInterval(enemyInterval);
Â Â Â Â Â Â Â resetGame();
Â Â Â Â Â });

Â Â Â Â Â function sendScore(name, score) {
Â Â Â Â Â Â Â google.script.run.submitScore(name, score);
Â Â Â Â Â }

Â Â Â Â Â function fetchRanking() {
Â Â Â Â Â Â Â spinner.style.display = "block";
Â Â Â Â Â Â Â rankingDisplay.innerHTML = "";

Â Â Â Â Â Â Â google.script.run
Â Â Â Â Â Â Â Â Â .withSuccessHandler(data => {
Â Â Â Â Â Â Â Â Â Â Â spinner.style.display = "none";
Â Â Â Â Â Â Â Â Â Â Â if (!data || !Array.isArray(data)) {
Â Â Â Â Â Â Â Â Â Â Â Â Â rankingDisplay.innerHTML = "<p style='color:red'>èª­ã¿è¾¼ã¿å¤±æ•—</p>";
Â Â Â Â Â Â Â Â Â Â Â Â Â return;
Â Â Â Â Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â Â Â Â Â let html = "<h3>ğŸ† ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h3><ol>";
Â Â Â Â Â Â Â Â Â Â Â data.forEach(row => {
Â Â Â Â Â Â Â Â Â Â Â Â Â const name = row[0] || "åç„¡ã—";
Â Â Â Â Â Â Â Â Â Â Â Â Â const score = typeof row[1] === "number" ? row[1] : "ï¼Ÿ";
Â Â Â Â Â Â Â Â Â Â Â Â Â html += `<li>${name} - ${score}ç‚¹</li>`;
Â Â Â Â Â Â Â Â Â Â Â });
Â Â Â Â Â Â Â Â Â Â Â html += "</ol>";
Â Â Â Â Â Â Â Â Â Â Â rankingDisplay.innerHTML = html;
Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â Â .withFailureHandler(error => {
Â Â Â Â Â Â Â Â Â Â Â spinner.style.display = "none";
Â Â Â Â Â Â Â Â Â Â Â rankingDisplay.innerHTML = `<span style="color:red">é€šä¿¡ã‚¨ãƒ©ãƒ¼</span>`;
Â Â Â Â Â Â Â Â Â })
Â Â Â Â Â Â Â Â Â .getRanking();
Â Â Â Â Â }

Â Â Â Â Â function update() {
Â Â Â Â Â Â Â if (gameOver) return;

Â Â Â Â Â Â Â bullets.forEach(b => b.y -= 8);
Â Â Â Â Â Â Â enemies.forEach(e => e.y += e.speed);

Â Â Â Â Â Â Â for (let e of enemies) {
Â Â Â Â Â Â Â Â Â if (e.y + e.h >= GAME_HEIGHT) {
Â Â Â Â Â Â Â Â Â Â Â gameOver = true;
Â Â Â Â Â Â Â Â Â Â Â gameOverDisplay.style.display = "block";
Â Â Â Â Â Â Â Â Â Â Â retryButton.style.display = "block";
Â Â Â Â Â Â Â Â Â Â Â clearInterval(enemyInterval);

Â Â Â Â Â Â Â Â Â Â Â const name = prompt("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:") || "åç„¡ã—";
Â Â Â Â Â Â Â Â Â Â Â sendScore(name, score);
Â Â Â Â Â Â Â Â Â Â Â fetchRanking();
Â Â Â Â Â Â Â Â Â Â Â return;
Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â }

Â Â Â Â Â Â Â bullets = bullets.filter(bullet => {
Â Â Â Â Â Â Â Â Â for (let i = 0; i < enemies.length; i++) {
Â Â Â Â Â Â Â Â Â Â Â const e = enemies[i];
Â Â Â Â Â Â Â Â Â Â Â if (
Â Â Â Â Â Â Â Â Â Â Â Â Â bullet.x > e.x &&
Â Â Â Â Â Â Â Â Â Â Â Â Â bullet.x < e.x + e.w &&
Â Â Â Â Â Â Â Â Â Â Â Â Â bullet.y > e.y &&
Â Â Â Â Â Â Â Â Â Â Â Â Â bullet.y < e.y + e.h
Â Â Â Â Â Â Â Â Â Â Â ) {
Â Â Â Â Â Â Â Â Â Â Â Â Â enemies.splice(i, 1);
Â Â Â Â Â Â Â Â Â Â Â Â Â score += 10;
Â Â Â Â Â Â Â Â Â Â Â Â Â scoreDisplay.textContent = "Score: " + score;
Â Â Â Â Â Â Â Â Â Â Â Â Â return false;
Â Â Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â }
Â Â Â Â Â Â Â Â Â return bullet.y > 0;
Â Â Â Â Â Â Â });

Â Â Â Â Â Â Â enemies = enemies.filter(e => e.y < GAME_HEIGHT);

Â Â Â Â Â Â Â ctx.clearRect(0, 0, GAME_WIDTH, GAME_HEIGHT);
Â Â Â Â Â Â Â ctx.fillStyle = "white";
Â Â Â Â Â Â Â ctx.fillRect(player.x, player.y, player.w, player.h);
Â Â Â Â Â Â Â bullets.forEach(b => ctx.fillRect(b.x, b.y, 4, 10));
Â Â Â Â Â Â Â enemies.forEach(e => ctx.fillRect(e.x, e.y, e.w, e.h));

Â Â Â Â Â Â Â requestAnimationFrame(update);
Â Â Â Â Â }

Â Â Â Â Â resetGame();
Â Â Â </script>
Â </body>
</html>



